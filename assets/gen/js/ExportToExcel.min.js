webpackJsonpCoveo__temporary([54],{298:function(t,o,n){"use strict";var e=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)o.hasOwnProperty(n)&&(t[n]=o[n])};return function(o,n){function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=n(8),r=n(9),s=n(40),l=n(12),p=n(2),u=n(10),c=n(1),a=n(4);n(567);var d=function(t){function o(n,e,i,l){var p=t.call(this,n,o.ID,i)||this;return p.element=n,p.options=e,p.bindings=i,p._window=l,p._window=p._window||window,p.options=r.ComponentOptions.initComponentOptions(n,o,e),p.bind.onRootElement(s.SettingsEvents.settingsPopulateMenu,function(t){t.menuData.push({text:u.l("ExportToExcel"),className:"coveo-export-to-excel",tooltip:u.l("ExportToExcelDescription"),onOpen:function(){return p.download()}})}),p}return e(o,t),o.prototype.download=function(){var t=this.queryController.getLastQuery();if(t){t=c.omit(t,"numberOfResults"),this.options.fieldsToInclude&&(t.fieldsToInclude=this.options.fieldsToInclude),this.logger.debug("Performing query following 'Export to Excel' click");var o=this.queryController.getEndpoint();this.usageAnalytics.logCustomEvent(l.analyticsActionCauseList.exportToExcel,{},this.element),this._window.location.replace(o.getExportToExcelLink(t,this.options.numberOfResults))}},o.create=function(t,n,e){return new o(t,n,e)},o}(i.Component);d.ID="ExportToExcel",d.doExport=function(){a.exportGlobally({ExportToExcel:d})},d.options={numberOfResults:r.ComponentOptions.buildNumberOption({defaultValue:100,min:1}),fieldsToInclude:r.ComponentOptions.buildFieldsOption()},o.ExportToExcel=d,p.Initialization.registerAutoCreateComponent(d)},567:function(t,o){}});