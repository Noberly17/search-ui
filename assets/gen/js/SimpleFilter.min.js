webpackJsonpCoveo__temporary([19],{16:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.addClassToSVGInContainer=function(t,i){var o=t.querySelector("svg");o.setAttribute("class",""+e.getClass(o)+i)},e.removeClassFromSVGInContainer=function(t,i){var o=t.querySelector("svg");o.setAttribute("class",e.getClass(o).replace(i,""))},e.getClass=function(e){var t=e.getAttribute("class");return t?t+" ":""},e}();t.SVGDom=o},320:function(e,t,i){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=i(8),l=i(2),s=i(4);i(434);var r=i(3),a=i(11),c=i(9),u=i(10),p=i(7),h=i(1),d=i(54),m=i(42),v=i(15),f=i(16),b=i(542),y=i(37),g=i(23),C=i(12),k=function(e){function t(i,o,n){var l=e.call(this,i,t.ID,n)||this;return l.element=i,l.options=o,l.bindings=n,l.previouslySelected=[],l.groupByRequestValues=[],l.isSticky=!1,l.options=c.ComponentOptions.initComponentOptions(i,t,o),l.element.title=l.options.title,l.buildContent(),r.$$(l.element).on("click",function(e){return l.handleClick(e)}),r.$$(l.element).setAttribute("tabindex","0"),l.bindKeyboardEvents(),l.bind.onRootElement(m.BreadcrumbEvents.populateBreadcrumb,function(e){return l.handlePopulateBreadcrumb(e)}),l.bind.onRootElement(m.BreadcrumbEvents.clearBreadcrumb,function(){return l.handleClearBreadcrumb()}),l.bind.onRootElement(a.QueryEvents.buildingQuery,function(e){return l.handleBuildingQuery(e)}),l.bind.onRootElement(a.QueryEvents.doneBuildingQuery,function(e){return l.handleDoneBuildingQuery(e)}),l.bind.onRootElement(a.QueryEvents.querySuccess,function(e){return l.handleQuerySuccess(e)}),l}return o(t,e),t.prototype.getValueContainer=function(){return this.valueContainer},t.prototype.getValueCaption=function(e){var t=e;return h.contains(h.keys(this.options.valueCaption),e)?(t=this.options.valueCaption[t]||t,u.l(t)):y.FacetUtils.tryToGetTranslatedCaption(this.options.field.toString(),t)},t.prototype.getSelectedCaptions=function(){var e=this;return h.map(this.getSelectedValues(),function(t){return e.getValueCaption(t)})},t.prototype.toggleContainer=function(){r.$$(this.valueContainer).hasClass("coveo-simplefilter-value-container-expanded")?this.closeContainer():this.openContainer()},t.prototype.selectValue=function(e,t){var i=this;void 0===t&&(t=!0),h.each(this.checkboxes,function(o){var n=i.getValueCaption(o.label);o.label!=e&&n!=e||o.checkbox.select(t)})},t.prototype.deselectValue=function(e){var t=this;h.each(this.checkboxes,function(i){var o=t.getValueCaption(i.label);i.label!=e&&o!=e||i.checkbox.reset()})},t.prototype.toggleValue=function(e){var t=this;h.each(this.checkboxes,function(i){var o=t.getValueCaption(i.label);i.label!=e&&o!=e||i.checkbox.toggle()})},t.prototype.resetSimpleFilter=function(){var e=this;h.each(this.checkboxes,function(t){t.checkbox.isSelected()&&e.deselectValue(t.label)})},t.prototype.openContainer=function(){r.$$(this.element).addClass("coveo-simplefilter-value-container-expanded"),this.valueContainer.addClass("coveo-simplefilter-value-container-expanded"),this.refreshValueContainer(),this.isSticky=!0,this.backdrop.hasClass("coveo-dropdown-background-active")||this.showBackdrop()},t.prototype.closeContainer=function(){r.$$(this.element).removeClass("coveo-simplefilter-value-container-expanded"),this.valueContainer.removeClass("coveo-simplefilter-value-container-expanded"),this.backdrop.hasClass("coveo-dropdown-background-active")&&this.hideBackdrop(),0==this.getSelectedLabeledCheckboxes().length&&(this.isSticky=!1)},t.prototype.getSelectedValues=function(){return h.map(this.getSelectedLabeledCheckboxes(),function(e){return e.label})},t.prototype.bindKeyboardEvents=function(){var e=this;r.$$(this.element).on("keyup",g.KeyboardUtils.keypressAction(g.KEYBOARD.ENTER,function(t){t.target==e.element?e.toggleContainer():e.toggleValue(r.$$(t.target).text())})),r.$$(this.element).on("blur",function(i){var o=i.relatedTarget;r.$$(o).parent(n.Component.computeCssClassName(t))||e.closeContainer()})},t.prototype.handleClick=function(e){e.stopPropagation(),e.target==this.element&&this.toggleContainer()},t.prototype.handleValueToggle=function(e){var t=this.getSelectedValues();this.circleElement.text(t.length.toString()),this.circleElement.removeClass("coveo-simplefilter-circle-hidden"),1==t.length?(this.setDisplayedTitle(this.getValueCaption(t[0])),this.element.title=this.getValueCaption(t[0])):(this.setDisplayedTitle(this.options.title),this.element.title=this.options.title,t.length<1&&this.circleElement.addClass("coveo-simplefilter-circle-hidden"));var i=e.isSelected()?C.analyticsActionCauseList.simpleFilterSelectValue:C.analyticsActionCauseList.simpleFilterDeselectValue;this.usageAnalytics.logSearchEvent(i,{simpleFilterTitle:this.options.title,simpleFilterSelectedValue:e.label,simpleFilterField:this.options.field}),this.queryController.executeQuery()},t.prototype.createCheckbox=function(e){var t=this,i=new d.Checkbox(function(){t.handleValueToggle(i)},this.getValueCaption(e));return i.getElement().title=u.l(e),r.$$(i.getElement()).setAttribute("tabindex","0"),{checkbox:i,label:e}},t.prototype.createCheckboxes=function(){var e=this;this.previouslySelected.length>0?(this.checkboxes=h.map(this.previouslySelected,function(t){return e.createCheckbox(t)}),h.each(this.checkboxes,function(t){e.previouslySelected.indexOf(t.label)>=0&&e.selectValue(t.label,!1)})):void 0!=this.options.values?this.checkboxes=h.map(this.options.values,function(t){return e.createCheckbox(t)}):void 0!=this.groupByRequestValues&&(this.checkboxes=h.map(this.groupByRequestValues,function(t){return e.createCheckbox(t)})),h.each(this.checkboxes,function(t){e.valueContainer.append(t.checkbox.getElement())});var t=h.last(r.$$(this.valueContainer).findAll(".coveo-checkbox-label"));r.$$(t).on("blur",function(){e.closeContainer()})},t.prototype.createValueContainer=function(){this.valueContainer=r.$$("div",{className:"coveo-simplefilter-value-container"})},t.prototype.buildContent=function(){this.createValueContainer(),this.element.appendChild(this.buildSelect()),this.element.appendChild(this.valueContainer.el),this.findOrCreateWrapper().append(this.element),this.createBackdrop()},t.prototype.buildSelect=function(){var e=r.$$("span",{className:"coveo-simplefilter-select"});return this.selectTitle=r.$$("span",{className:"coveo-simplefilter-selecttext"},this.getValueCaption(this.options.title)),e.append(this.selectTitle.el),e.append(this.buildCircleElement()),e.append(this.buildSvgToggleUpIcon()),e.el},t.prototype.buildSvgToggleUpIcon=function(){var e=r.$$("span",null,v.SVGIcons.icons.arrowDown).el;return f.SVGDom.addClassToSVGInContainer(e,"coveo-simplefilter-toggle-down-svg"),e},t.prototype.buildCircleElement=function(){return this.circleElement=r.$$("span",{className:"coveo-simplefilter-circle coveo-simplefilter-circle-hidden"},this.getSelectedLabeledCheckboxes().length.toString()),this.circleElement.el},t.prototype.createBackdrop=function(){var e=this,t=r.$$(this.root).find(".coveo-dropdown-background");null==t?(this.backdrop=r.$$("div",{className:"coveo-dropdown-background"}),this.root.appendChild(this.backdrop.el)):this.backdrop=r.$$(t),this.backdrop.on("click",function(){return e.closeContainer()})},t.prototype.handlePopulateBreadcrumb=function(e){var t=this;if(this.getSelectedLabeledCheckboxes().length>0){var i=r.$$("div",{className:"coveo-simplefilter-breadcrumb"}),o=r.$$("span",{className:"coveo-simplefilter-breadcrumb-title"},this.options.title);i.append(o.el);var n=r.$$("span",{className:"coveo-simplefilter-breadcrumb-values"});i.append(n.el),h.each(this.getSelectedLabeledCheckboxes(),function(e){var i=r.$$("span",{className:"coveo-simplefilter-breadcrumb-value"},t.getValueCaption(e.label));n.append(i.el);var o=r.$$("span",{className:"coveo-simplefilter-breadcrumb-clear"},v.SVGIcons.icons.checkboxHookExclusionMore);f.SVGDom.addClassToSVGInContainer(o.el,"coveo-simplefilter-breadcrumb-clear-svg"),i.append(o.el),i.el.title=t.getValueCaption(e.label),r.$$(i).on("click",function(){return t.handleRemoveFromBreadcrumb(e)})}),e.breadcrumbs.push({element:i.el})}},t.prototype.handleRemoveFromBreadcrumb=function(e){e.checkbox.reset(),this.refreshValueContainer()},t.prototype.handleClearBreadcrumb=function(){this.usageAnalytics.logSearchEvent(C.analyticsActionCauseList.simpleFilterClearAll,{simpleFilterTitle:this.options.title,simpleFilterField:this.options.field}),this.resetSimpleFilter()},t.prototype.handleQuerySuccess=function(e){e.results.results.length>0?this.findOrCreateWrapper().removeClass("coveo-no-results"):this.findOrCreateWrapper().addClass("coveo-no-results"),void 0==this.options.values&&(this.groupByBuilder.groupBy(e),this.groupByRequestValues=this.groupByBuilder.getValuesFromGroupBy(),this.refreshValueContainer(),r.$$(this.element).hasClass("coveo-simplefilter-value-container-expanded")||(this.isSticky=!1))},t.prototype.handleBuildingQuery=function(e){p.Assert.exists(e),p.Assert.exists(e.queryBuilder);var t=this.getSelectedValues();t.length>0&&e.queryBuilder.advancedExpression.addFieldExpression(this.options.field.toString(),"==",t)},t.prototype.handleDoneBuildingQuery=function(e){void 0==this.options.values&&(p.Assert.exists(e),p.Assert.exists(e.queryBuilder),this.previouslySelected=this.getSelectedValues(),this.groupByBuilder=new b.SimpleFilterValues(this,this.options),this.groupByBuilder.handleDoneBuildingQuery(e))},t.prototype.getSelectedLabeledCheckboxes=function(){return h.filter(this.checkboxes,function(e){return e.checkbox.isSelected()})},t.prototype.setDisplayedTitle=function(e){this.selectTitle.text(this.getValueCaption(e))},t.prototype.getDisplayedTitle=function(){return this.selectTitle.text()},t.prototype.showBackdrop=function(){this.backdrop.addClass("coveo-dropdown-background-active")},t.prototype.hideBackdrop=function(){this.backdrop.removeClass("coveo-dropdown-background-active")},t.prototype.getBackdrop=function(){return this.backdrop},t.prototype.findOrCreateWrapper=function(){if(null==r.$$(this.root).find(".coveo-simplefilter-header-wrapper")){var e=r.$$("div",{className:"coveo-simplefilter-header-wrapper"});return e.insertBefore(this.element),e}var e=r.$$(this.root).find(".coveo-simplefilter-header-wrapper");return r.$$(e)},t.prototype.refreshValueContainer=function(){this.isSticky||(this.valueContainer.empty(),this.createCheckboxes()),0!=this.checkboxes.length||this.isSticky?r.$$(this.element).removeClass("coveo-simplefilter-empty"):r.$$(this.element).addClass("coveo-simplefilter-empty"),r.$$(this.circleElement).text(this.getSelectedLabeledCheckboxes().length.toString())},t.ID="SimpleFilter",t.doExport=function(){s.exportGlobally({SimpleFilter:t})},t.options={maximumNumberOfValues:c.ComponentOptions.buildNumberOption({defaultValue:5,min:0}),values:c.ComponentOptions.buildListOption(),field:c.ComponentOptions.buildFieldOption({required:!0}),title:c.ComponentOptions.buildStringOption({defaultValue:u.l("NoTitle")}),valueCaption:c.ComponentOptions.buildJsonObjectOption()},t}(n.Component);t.SimpleFilter=k,l.Initialization.registerAutoCreateComponent(k)},434:function(e,t){},542:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(434);var o=i(1),n=function(){function e(e,t){this.simpleFilter=e,this.options=t,this.groupByRequestValues=[]}return e.prototype.getValuesFromGroupBy=function(){return this.groupByRequestValues},e.prototype.groupBy=function(e){var t=this;this.groupByRequestValues=[];var i=e.results.groupByResults;i.length>0&&void 0!=this.position&&o.each(i[this.position].values,function(e){t.groupByRequestValues.indexOf(e.lookupValue)<0&&t.groupByRequestValues.push(e.lookupValue)})},e.prototype.handleDoneBuildingQuery=function(e){var t=e.queryBuilder;this.putGroupByIntoQueryBuilder(t)},e.prototype.putGroupByIntoQueryBuilder=function(e){var t=this.createBasicGroupByRequest();e.groupByRequests.push(t),this.position=e.groupByRequests.length-1},e.prototype.createBasicGroupByRequest=function(){return{field:this.options.field,maximumNumberOfValues:this.options.maximumNumberOfValues,injectionDepth:1e3}},e}();t.SimpleFilterValues=n}});